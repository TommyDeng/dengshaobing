<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>

<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />

<link rel="stylesheet" href="/dengshaobing/css/bootstrap.min.css" />
<script src="/dengshaobing/js/jquery-3.1.0.min.js"></script>
<script src="/dengshaobing/js/bootstrap.min.js"></script>

<script type="text/javascript">
	function changeItemQty(itemUC, AT, inputItem, itemPrice) {
		var itemCount = $(inputItem).val();
		$.post("changeItemQty", {
			itemUC : itemUC,
			AT : AT,
			itemCount : itemCount
		}, function(resultVar) {
			var targetRefreshItem = $(inputItem).parent().parent().siblings()
					.next().next();
			targetRefreshItem.fadeToggle('fast');
			targetRefreshItem.children().html(itemPrice * inputItem);
			targetRefreshItem.fadeToggle('fast');
		});
	}
</script>


<title></title>

</head>
<body style="padding-bottom: 70px; padding-top: 70px;">
	<div class="container">
		<nav class="navbar-default navbar-fixed-top">

			<div class="pull-left" style="margin: 10px">
				<a class="btn btn-default" type="button" th:href="@{main(AT=${AT})}">
					<span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span>
					<span>Back</span>
				</a>
			</div>
			<div class="pull-right" style="margin: 10px">
				<a class="btn btn-primary" type="button"
					th:href="@{checkout(AT=${AT})}"> <span
					class="glyphicon glyphicon-credit-card" aria-hidden="true"></span>
					Checkout
				</a>
			</div>
		</nav>
	</div>
	<div class="container">
		<table class="table table-striped table-condensed">
			<caption th:text="${tableMeta.title}">SHOPPING CART</caption>
			<thead>
				<tr>
					<th th:each="head : ${tableMeta.headList}"
						th:text="${head.columnLabel}" th:if="${head.display}"></th>
				</tr>
			</thead>
			<tbody th:remove="all-but-first">
				<tr th:each="recode : ${tableMeta.dataList}">

					<td th:each="head : ${tableMeta.headList}" th:if="${head.display}">
						<div
							th:if="${head.uriAttachable and !head.columnLabel.equals('数量')}">
							<a th:text="${recode[__${head.index}__]}"
								th:href="@{item(rowUC=${recode[2]},AT=${AT})}"></a>
						</div>
						<div
							th:if="${!head.uriAttachable and !head.columnLabel.equals('数量')}">
							<label th:text="${recode[__${head.index}__]}"></label>
						</div>
						<div th:if="${head.columnLabel.equals('数量')}">
							<input type="number" th:value="${recode[__${head.index}__]}"
								th:width="80px"
								th:onchange="'changeItemQty(\''+${recode[1]}+'\',\''+${AT}+'\',this,\''+${recode[4]}+'\');'"></input>
						</div>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
</body>
</html>