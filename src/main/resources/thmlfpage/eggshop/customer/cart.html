<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="base :: common_header(~{::title},~{::link})">
</head>
<script type="text/javascript">
	function changeItemQty(cartItemUC, AT, inputItem, itemPrice) {
		var itemCount = $(inputItem).val();
		$.post("changeItemQty", {
			cartItemUC : cartItemUC,
			AT : AT,
			itemCount : itemCount
		}, function(resultVar) {
			var targetRefreshItem = $(inputItem).parent().parent().siblings()
					.last().children().children();
			targetRefreshItem.fadeToggle('fast');
			targetRefreshItem.html(resultVar * itemPrice);
			targetRefreshItem.fadeToggle('fast');
		});
	}
</script>
<body class="shop-main-page-body">
	<div th:insert="/eggshop/common/fragment :: shop-header"></div>
	<div class="container">
		<table class="table table-striped table-sm">
			<thead>
				<tr>
					<th th:each="head : ${tableMeta.headList}"
						th:text="${head.columnLabel}" th:if="${head.display}"></th>
				</tr>
			</thead>
			<tbody th:remove="all-but-first">
				<tr th:each="recode : ${tableMeta.dataList}">

					<td th:each="head : ${tableMeta.headList}" th:if="${head.display}">
						<div
							th:if="${head.uriAttachable and !head.columnLabel.equals('数量')}">
							<a th:text="${recode[__${head.index}__]}"
								th:href="@{item(rowUC=${recode[2]},AT=${AT})}"></a>
						</div>
						<div
							th:if="${!head.uriAttachable and !head.columnLabel.equals('数量')}">
							<label th:text="${recode[__${head.index}__]}"></label>
						</div>
						<div th:if="${head.columnLabel.equals('数量')}">
							<input type="number" th:value="${recode[__${head.index}__]}"
								style="width: 80px"
								th:onchange="'changeItemQty(\''+${recode[1]}+'\',\''+${AT}+'\',this,\''+${recode[4]}+'\');'"></input>
						</div>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
	<div th:insert="/eggshop/common/fragment :: shop-footer(3)"></div>
</body>
</html>